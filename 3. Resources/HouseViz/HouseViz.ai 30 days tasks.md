下面是为 **HouseViz.ai** 设计的 **30 天开发任务板（Trello 卡片式）**。每一张“卡片”都包含：任务描述、优先级、估时、负责人建议、依赖、验收条件（Acceptance Criteria）和测试要点。把它直接贴进你的 Trello/Notion 即可开始执行。

我把 30 天划分为 4 周（含缓冲与发布日）。假设你是独立开发者（Full-stack），可按需把部分任务外包给 UI 设计或视频/AI 外包团队。

---

# 总体目标（30 天结束时的 MVP 验收）

- 用户可以在 2D 地图上选中建筑 → 输入所在层/总层 → （可选）上传/对齐户型图或手绘房屋范围 → 在大屏 3D 弹窗看到周边建筑体块 + 时间轴动画 → 生成可下载的 PDF 报告（包含至少三张时间截图 + AI 生成的可编辑文案）。
    
- 功能稳定、能做 demo 给 10 位经纪人试用；在报告页显示数据来源与免责声明。
    

---

# 项目设置（Day 0–2）

### 卡片：项目初始化与环境搭建

- **优先级**：P0
    
- **估时**：0.5–1 天
    
- **负责人**：开发者（你）
    
- **描述**：初始化仓库（Git），创建 Next.js 项目模板，配置 ESLint/Prettier，创建 Trello 看板 & 任务模板。
    
- **依赖**：无
    
- **验收条件**：仓库有 README、CI（GitHub Actions 简单 lint/部署触发），Next.js 可运行 `npm run dev`。
    

### 卡片：域名、部署与密钥准备

- **优先级**：P0
    
- **估时**：0.5 天
    
- **负责人**：开发者
    
- **描述**：准备 houseviz.ai DNS，创建 Vercel 项目（或你偏好的托管），在环境变量添加 MAPBOX_TOKEN、OPENAI_KEY（或AI stub）、S3/云存储凭证、Stripe（若需要）。
    
- **依赖**：项目初始化
    
- **验收条件**：能部署到 staging 地址并访问，环境变量能在运行时读取。
    

---

# 第1周（Day 1–7）：地图交互 + 建筑数据管线（P0）

### 卡片：Mapbox 2D 地图基础与底图加载

- **优先级**：P0
    
- **估时**：1 天
    
- **负责人**：开发者
    
- **描述**：集成 Mapbox GL JS（或 Maplibre），显示可缩放平移地图，加入搜索（Mapbox Geocoding 或简单地址输入）。
    
- **依赖**：MAPBOX_TOKEN env
    
- **验收条件**：页面能渲染地图，能搜索并定位到地址；无地图报错。
    
- **测试**：搜索若干地址，地图定位正确；不同浏览器加载正常。
    

### 卡片：建筑点击与 footprint 获取（Mapbox / OSM）

- **优先级**：P0
    
- **估时**：1–1.5 天
    
- **负责人**：开发者
    
- **描述**：实现 `map.queryRenderedFeatures` 获取被点击建筑 feature；后端 API `/api/feature?osm_id=` 以 Overpass/Mapbox 返回 GeoJSON + properties（height/levels）。
    
- **依赖**：Mapbox 集成
    
- **验收条件**：点击建筑后弹出侧栏显示建筑 footprint（多边形）与属性（若有 height/levels）；若无属性显示“未知”。
    
- **测试**：点击多种建筑（有/无 metadata），正确返回或提示。
    

### 卡片：手绘/绘制工具（fallback）

- **优先级**：P1（若 Mapbox 未找到）
    
- **估时**：0.5–1 天
    
- **负责人**：开发者
    
- **描述**：在没有 footprint 时允许用户用 draw 工具手绘多边形。
    
- **依赖**：Map UI
    
- **验收条件**：用户能画多边形并保存到本地 state，用作后续建模输入。
    
- **测试**：绘制、编辑、取消、保存流程无误。
    

### 卡片：楼层判定逻辑与弹窗表单（层数输入）

- **优先级**：P0
    
- **估时**：0.5 天
    
- **负责人**：开发者 / UX
    
- **描述**：读取 feature.properties（height/levels）判断 high-rise（默认阈值6层/18m），如高层或未知弹表单要求输入：所居层、总层、层高（可选）。显示地图数据与用户输入的对比提示。
    
- **依赖**：feature API
    
- **验收条件**：弹窗校验（所居层 <= 总层），能提交并保存到 session/local storage。
    
- **测试**：不同输入组合验证提示与校验工作。
    

---

# 第2周（Day 8–14）：客户端 3D 建模 & WebWorker（P0）

### 卡片：Three.js 3D Modal 基础（弹窗 + 3D 画布）

- **优先级**：P0
    
- **估时**：1 天
    
- **负责人**：开发者
    
- **描述**：实现 modal 弹窗，初始化 Three.js 场景、相机、灯光、轨迹控制（OrbitControls）。
    
- **依赖**：楼层表单提交流程
    
- **验收条件**：点击“进入 3D” 打开 modal 并显示可旋转场景，默认地面与网格投影。
    
- **测试**：旋转/缩放/重置视角工作。
    

### 卡片：从 footprint 到 extrude 几何（客户端近似建模）

- **优先级**：P0
    
- **估时**：1.5–2 天
    
- **负责人**：开发者
    
- **描述**：把 GeoJSON footprint 转为 Three.js 几何（投影到 WebMercator，再按层数×层高生成高度），生成建筑体块与简单材质。做到周边建筑拉取 + 一起 extrude（半径默认 100–200m）。
    
- **依赖**：/api/buildings/nearby
    
- **验收条件**：选择建筑且提交层数后，modal 展示目标建筑与周边建筑体块，比例与方位正确。
    
- **测试**：多地址、多楼层测试（不同设备），检查遮挡和尺寸感。
    

### 卡片：使用 WebWorker 做几何 / 阴影投影计算（性能优化）

- **优先级**：P0
    
- **估时**：1 天
    
- **负责人**：开发者
    
- **描述**：把阴影投影与大规模几何计算放到 WebWorker，主线程仅接受 mesh 数据并渲染，避免卡顿。
    
- **依赖**：Three.js 场景渲染
    
- **验收条件**：在大约 100 个建筑体块场景下（mid-range 笔记本），交互不低于 20 FPS；主线程不卡死。
    
- **测试**：监测 FPS、CPU 占用与内存泄露。
    

---

# 第3周（Day 15–21）：时间轴 + 阴影算法 + 报告初版（P0）

### 卡片：太阳位置计算模块（suncalc / SPA）

- **优先级**：P0
    
- **估时**：0.5 天
    
- **负责人**：开发者
    
- **描述**：集成 suncalc 或更精确 SPA 模块，输入地点与时间得到太阳方位角和高度角。
    
- **依赖**：地理坐标获取
    
- **验收条件**：给定经纬与时间，返回合理的方位角 & 高度（简单验证：在同一天早中晚角度变化正常）。
    
- **测试**：对比已知太阳位置时间点（简单 sanity check）。
    

### 卡片：实时阴影投影（客户端快速近似）

- **优先级**：P0
    
- **估时**：1.5 天
    
- **负责人**：开发者
    
- **描述**：基于太阳向量对每栋建筑顶点做投影，生成地面阴影多边形并渲染为半透明层；时间轴滚动实时更新阴影。
    
- **依赖**：WebWorker、Three.js、太阳模块
    
- **验收条件**：时间轴拖动时阴影同步变化；常见场景下阴影方向与长度符合直觉（早低、正午短、傍晚长）。
    
- **测试**：在不同时间点记录截图，人工核验方向/长度；在手机端测试帧率。
    

### 卡片：时间轴控件与 UI（早/午/晚/季/年切换）

- **优先级**：P0
    
- **估时**：0.5–1 天
    
- **负责人**：开发者 / UI
    
- **描述**：实现可拖动时间轴与预设按钮（今天 / 冬至 / 夏至 / 典型工作日 8:00/12:00/18:00）。与阴影模块联动。
    
- **依赖**：阴影投影实现
    
- **验收条件**：拖动时间轴即时渲染阴影；预设按钮快速跳转。
    
- **测试**：功能在桌面 + 移动端正常。
    

### 卡片：PDF 报告导出初版（含截图和模板）

- **优先级**：P0
    
- **估时**：1.5 天
    
- **负责人**：开发者
    
- **描述**：实现服务器或客户端导出 PDF：包含封面（地址、楼层）、3 张关键时间截图（早/中/晚）、AI 文案 placeholder。可下载并带 footer（数据来源 + 免责声明）。
    
- **依赖**：前端截图生成（canvas 或 glReadPixels）、后端 PDF 库（puppeteer / pdfkit）
    
- **验收条件**：生成的 PDF 格式整齐，包含三张截图与默认文案与免责声明；能在浏览器下载并打开。
    
- **测试**：多例地址生成并检查排版、图片清晰度、文件大小（控制）。
    

---

# 第4周（Day 22–30）：AI 文案、视频短片原型、QA 与上线（P0→P1）

### 卡片：AI 文案自动化（OpenAI 集成或本地模板）

- **优先级**：P0
    
- **估时**：1–1.5 天
    
- **负责人**：开发者 / 内容
    
- **描述**：把报告要点（采光时长、关键时刻截图、地段要素经纪人输入）传给 AI 模型生成“可编辑报告段落”。若没有 OpenAI key，可先使用模板 + string interpolation。
    
- **依赖**：报告导出流程、OPENAI_KEY（若用）
    
- **验收条件**：生成文本逻辑正确、可编辑、并在报告预览中可以被替换/修改。
    
- **测试**：几条不同示例输入，检查 AI 生成内容的相关性与可编辑性。
    

### 卡片：视频生成原型（导出时间轴动画 + TTS）

- **优先级**：P1（可延后，但建议试做）
    
- **估时**：1–2 天
    
- **负责人**：开发者 / 外包（如需高质量）
    
- **描述**：实现导出 15–30 秒的视频：WebGL 时间轴动画录屏（客户端生成或服务器 headless render）+ AI TTS 旁白（OpenAI TTS 或其他）。先做低分辨率版以控制成本。
    
- **依赖**：3D 场景、PDF 截图、TTS 服务
    
- **验收条件**：能生成一段包含时间轴动画与旁白的 MP4，时长 15–30s，音频与画面同步。
    
- **测试**：录制不同地址生成的视频并播放检查。
    

### 卡片：报告编辑器（WYSIWYG）与保存（草稿）

- **优先级**：P1
    
- **估时**：1 天
    
- **负责人**：开发者
    
- **描述**：允许经纪人在生成后编辑 AI 文案，并保存为草稿/版本以供导出。版本记录最少保留最近 3 次更改。
    
- **依赖**：AI 文案生成、后端存储（或 localStorage）
    
- **验收条件**：编辑器能保存、回滚到上一版本并导出最新版本的 PDF。
    
- **测试**：编辑后导出 PDF，检查文本变化生效。
    

### 卡片：免责声明 & 合规页（必做）

- **优先级**：P0
    
- **估时**：0.5 天
    
- **负责人**：开发者 / 法务（如有）
    
- **描述**：在报告 footer 和 UI 明显位置放置免责声明模板，注明“基于OSM/用户输入，仅供参考”；准备短版本 TOS 与隐私要点。
    
- **依赖**：报告导出流程
    
- **验收条件**：所有导出的 PDF 都含免责声明文字及数据来源标注；首页显示服务说明链接。
    
- **测试**：生成报告并确认免责声明显示且文本准确。
    

### 卡片：端到端 QA、性能与可用性修复

- **优先级**：P0
    
- **估时**：1.5–2 天
    
- **负责人**：开发者 / QA
    
- **描述**：全流程测试（地图→楼层→3D→时间轴→PDF→AI 编辑→导出视频），修复阻断性 bug，优化加载/渲染性能。
    
- **依赖**：所有功能到位
    
- **验收条件**：关键路径（地图点选→导出PDF）在 10 次连续运行中无致命错误；移动端、桌面端主要浏览器无阻断性缺陷。
    
- **测试**：列出 20 个验收测试用例并通过（见下方测试用例清单）。
    

### 卡片：部署到 production（Vercel） + Launch checklist

- **优先级**：P0
    
- **估时**：0.5 天
    
- **负责人**：开发者
    
- **描述**：把 staging 测试分支合并，部署 production，配置域名、SSL、环境变量，并检查 logs/monitoring。准备 demo 链接与演示脚本。
    
- **依赖**：QA 完成
    
- **验收条件**：production 可访问，生成报告/视频功能在 production 工作正常，域名生效。
    
- **测试**：访问生产主页，完成一次完整流程并下载报告。
    

### 卡片：初始 BD / 试点邀约包（并行任务）

- **优先级**：P1（并行）
    
- **估时**：0.5–1 天
    
- **负责人**：你（创始人/BD）
    
- **描述**：准备给 10 位本地经纪人的试点邮件/演示材料（含 demo 链接、示例报告），预约 1 周内演示。
    
- **依赖**：产品 demo 可用
    
- **验收条件**：至少安排 3 个演示会或试点同意使用。
    

---

# 验收测试用例（示例，至少 20 个，用于 QA 阶段）

1. 地图搜索一个地址，点击建筑弹出信息（成功）。
    
2. 点击有 `building:levels` 的建筑，弹窗显示并默认填充层数（成功/正确）。
    
3. 点击无属性建筑时提示绘制或输入（成功）。
    
4. 输入不合法层数（userFloor > totalFloors）时阻止提交（验证）。
    
5. 提交层数后能打开 3D modal（成功）。
    
6. 3D modal 场景能旋转、缩放（交互测试）。
    
7. 建筑 extrude 高度与所填层数一致（验证）。
    
8. 时间轴拖动时阴影方向/长度随时间变化（直觉测试）。
    
9. 导出 PDF 包含 3 张时间截图与 AI 文案（成功）。
    
10. PDF footer 包含免责声明与数据来源（成功）。
    
11. 在移动端（iOS Safari / Android Chrome）执行完整流程（正常）。
    
12. WebWorker 未阻塞主线程，长场景帧率>=20（性能）。
    
13. 上传户型图并手工对齐（若实现，验证对齐后采光目标位置正确）
    
14. AI 文案可编辑并保存（版本记录）
    
15. 视频生成（低分辨率原型）播放正常并有 TTS（若实现）
    
16. 生成失败时显示可理解错误并允许重试（错误处理）
    
17. 多用户并发请求时后端无致命崩溃（负载基本验收）
    
18. 导出 PDF 文件大小可控（< 5MB 推荐）
    
19. 日志记录关键事件（report generated, video generated）成功
    
20. Demo 链接能在团队成员处访问并运行（发布验证）
    

---

# 后备/延伸任务（未进入 30 天优先级，可列 backlog）

- 高精度点位采光统计（小时/年，服务器离线批处理）
    
- 白标/公司版登录与团队管理（SAML/SSO）
    
- Stripe 订阅与计费系统集成（Tier & quota）
    
- 高质量视频生成 pipeline（Blender/Headless GL，GPU 集群）
    
- 户型图自动解析（CV 模型训练）与 AI 装修推荐模块
    
- API/Widget for MLS/portal embedding
    

---

# 项目管理小贴士（给独立开发者的实操建议）

1. **每日 standup（自检）**：写 15 分钟日志：昨天做了什么、今天要做什么、有什么阻碍。
    
2. **分支策略**：feature/xxx -> dev -> main，main 仅合并 release-ready code。
    
3. **可演示最小步进**：每天保证一个可演示的小进度（例如：地图点击到弹窗、或 3D modal 的单体 extrude）。
    
4. **日志与监控**：上线后第一周务必开启 Sentry（错误监控）与简单 usage logging（生成次数、失败率）。
    
5. **风险缓冲**：保留 2 天缓冲做上线与应急修复（已包含在 30 天计划中）。
    

---

# 交付物（30 天末应具备）

- houseviz.ai production 可访问链接（含 SSL）
    
- MVP 基本功能：地图选楼→层数输入→3D modal→时间轴→PDF报告（含 AI 文案）
    
- 10 个 Demo 用例（示例报告）用于 BD outreach
    
- 简短演示脚本（5–7 分钟）与 10 个经纪人试点邀约列表
    
- 基础合规文档（免责声明、隐私要点、数据来源说明）
    

---

如果你愿意，我可以把上述任务直接转成：

- Trello 格式的 CSV（每张卡含标题、描述、优先级、预计耗时、验收条件），你可以直接导入 Trello；  
    或
    
- GitHub Project 卡片（issue 模板）一键生成。
    

你要我把任务导出为 Trello 可导入的 CSV，还是把首周的关键实现（地图→楼层→3D modal）写成更细粒度的代码级实现步骤（含关键函数/伪代码）？